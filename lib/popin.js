"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),Popin=function(){function e(n){var t=this;_classCallCheck(this,e);var o={overlay:!0};if(n)for(var i in n)o.hasOwnProperty(i)&&(defaultOptions[i]=n[i]);if(this.popins=document.querySelectorAll(o&&o.popin?o.popin:".js-popin"),this.isDevice="ontouchstart"in document.documentElement,this.instanciedPopins=[],this.instanciedPopinsOptions=[],this.openedPopins=[],o.overlay){var s=document.createElement("div");s.id="popin-overlay",s.className="popin-overlay",document.body.appendChild(s),this.overlay=document.getElementById("popin-overlay"),this.overlay.addEventListener("click",function(e){t.close()},!1)}}return _createClass(e,[{key:"init",value:function(e){var n=this,t={overlayVisible:!0,closeButton:!0};if(e)for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);if(t.className&&(this[t.className]=document.querySelectorAll("."+t.className)),t.content){var i=document.createElement("div");i.id="popin-"+this.instanciedPopins.length,i.className="popin",i.innerHTML=t.content,document.body.appendChild(i)}[].forEach.call(this[t.className]?this[t.className]:this.popins,function(e,o){var i={overlayVisible:t.overlayVisible,closeButton:t.closeButton,popinId:t.content?"popin-"+n.instanciedPopins.length:e.getAttribute("data-target")};e.setAttribute("data-popin-id",n.instanciedPopins.length),n.instanciedPopins.push(i.popinId),n.instanciedPopinsOptions.push(i),e.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),n.open(e,n.instanciedPopinsOptions[t.target.getAttribute("data-popin-id")])})})}},{key:"open",value:function(e,n){var t=this;this.openedPopins.length>0&&document.getElementById(this.instanciedPopins[this.openedPopins.length-1]).classList.add("popin--closeJs"),n.beforeOpen&&"function"==typeof n.beforeOpen&&n.beforeOpen();var o=document.getElementById(n.popinId);n.overlayVisible&&0==this.openedPopins.length&&this.overlay.classList.add("popin-overlay--visible"),this.openedPopins.push(e.getAttribute("data-popin-id"));var i=document.documentElement.clientHeight,s=o.clientHeight;if(s>i?(o.style.top=document.body.scrollTop+20+"px",o.classList.add("popin--openJs")):o.classList.add("popin--open"),console.log(n),n.closeButton){var p=o.querySelector(".js-popin-linkClose");p.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.close(n)})}n.afterOpen&&"function"==typeof n.afterOpen&&n.afterOpen()}},{key:"close",value:function(e){if(!e)var e={};e.beforeClose&&"function"==typeof e.beforeClose&&e.beforeClose();var n=this.openedPopins[this.openedPopins.length-1],t=document.getElementById(this.instanciedPopins[n]);t.classList.remove("popin--open","popin--openJs"),t.style.top="",this.openedPopins.splice(this.openedPopins.length-1,1),this.openedPopins.length>0&&document.getElementById(this.instanciedPopins[this.openedPopins.length-1]).classList.remove("popin--closeJs"),0==this.openedPopins.length&&this.overlay.classList.remove("popin-overlay--visible"),e.afterClose&&"function"==typeof e.afterClose&&e.afterClose()}}]),e}();exports["default"]=Popin,module.exports=exports["default"];